/*! DisqusJS v1.3.0 | Sukka (https://skk.moe) | https://disqusjs.skk.moe | MIT License */
"use strict";function DisqusJS(s){!function(e,t,n,r,o){function a(){for(var s=arguments.length,e=new Array(s),t=0;s>t;t++)e[t]=arguments[t];return(a=Object.assign||function(s){for(var e=0,t=arguments.length;t>e;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(s[r]=n[r])}return s}).apply(this,e)}function i(){var s;e.DISQUS?e.DISQUS.reset({reload:!0,config:function(){this.page.identifier=M.config.identifier,this.page.url=M.config.url,this.page.title=M.config.title}}):(s=t.createElement("script"),q(j).innerHTML='<div id="dsqjs"><section><div id="dsqjs-msg">\u8bc4\u8bba\u5b8c\u6574\u6a21\u5f0f\u52a0\u8f7d\u4e2d... \u5982\u679c\u957f\u65f6\u95f4\u65e0\u6cd5\u52a0\u8f7d\uff0c\u8bf7\u9488\u5bf9 disq.us | disquscdn.com | disqus.com \u542f\u7528\u4ee3\u7406\uff0c\u6216\u5207\u6362\u81f3 <a id="dsqjs-force-dsqjs" class="dsqjs-msg-btn">\u8bc4\u8bba\u57fa\u7840\u6a21\u5f0f</a></div></section>'+b+"</div>",q("dsqjs-force-dsqjs").addEventListener(h,m),s.src="https://"+M.config.shortname+".disqus.com/embed.js",s.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(s))}function d(){function s(s){return new o(function(e,t){var n=new Image,r=setTimeout(function(){n.onerror=n.onload=null,t()},3e3);n.onerror=function(){clearTimeout(r),t()},n.onload=function(){clearTimeout(r),e()},n.src="https://"+s+"/favicon.ico?"+ +new Date+"="+ +new Date})}return q(j).innerHTML='<div id="dsqjs"><section><div id="dsqjs-msg">\u6b63\u5728\u68c0\u67e5 Disqus \u80fd\u5426\u8bbf\u95ee...</div></section>'+b+"</div>",o.all([s("disqus.com"),s(M.config.shortname+".disqus.com")]).then(p,m)}function c(){q("dsqjs-reload-disqus").addEventListener(h,d),q("dsqjs-force-disqus").addEventListener(h,p)}function l(){function s(s){function e(s){return{comment:s,author:s.author.name,isPrimary:!!M.config.admin&&s.author.username===M.config.admin,children:r(+s.id),hasMore:s.hasMore}}var t=[],n=[],r=function(s){if(0===n.length)return null;var t=[];return n.forEach(function(n){n.parent===s&&t.unshift(e(n))}),t.length?t:null};return s.forEach(function(s){(s.parent?n:t).push(s)}),t.map(e)}f("\u8bc4\u8bba\u57fa\u7840\u6a21\u5f0f\u52a0\u8f7d\u4e2d... "+L),c();var e=M.config.api+"3.0/threads/list.json?forum="+encodeURIComponent(M.config.shortname)+"&thread="+encodeURIComponent("ident:"+M.config.identifier)+"&api_key="+encodeURIComponent(C());T(e).then(function(s){var e=s.data;if(0===e.code&&1===e.response.length){var t=e.response[0],r=t.id,o=t.title,a=t.isClosed,i=t.posts;M.page={id:r,title:o,isClosed:a,length:i,comment:[]},q(j).innerHTML='<div id="dsqjs"><div id="dsqjs-msg">\u8bc4\u8bba\u57fa\u7840\u6a21\u5f0f\u52a0\u8f7d\u4e2d... '+L+"</div>"+y(i,M.config.siteName)+'<section class="dsqjs-post-container"><ul class="dsqjs-post-list" id="dsqjs-post-container"><p class="dsqjs-no-comment">\u8bc4\u8bba\u5217\u8868\u52a0\u8f7d\u4e2d...</p></ul><a id="dsqjs-load-more" class="dsqjs-load-more dsqjs-hide">\u52a0\u8f7d\u66f4\u591a\u8bc4\u8bba</a></section>'+b+"</div>",c(),q("dsqjs-order-"+M.sortType).setAttribute("checked","true"),n()}else{if(0!==e.code||1===e.response.length)throw new Error;f('\u5f53\u524d Thread \u5c1a\u672a\u521b\u5efa\u3002\u662f\u5426\u5207\u6362\u81f3 <a id="dsqjs-force-disqus" class="dsqjs-msg-btn">\u5b8c\u6574 Disqus \u6a21\u5f0f</a>\uff1f'),q("dsqjs-force-disqus").addEventListener(h,p)}})["catch"](u);var n=function o(s){function e(){Array.prototype.slice.call(l).forEach(function(s){return s.removeEventListener("change",v)}),i.removeEventListener(h,j),Array.prototype.slice.call(p).forEach(function(s){return s.removeEventListener(h,d)})}function n(s){var e=s.createdAt;return Date.parse(new Date(e))}function a(s,e){return s.parent&&e.parent?n(s)-n(e):0}void 0===s&&(s="");var i=q("dsqjs-load-more"),l=t.getElementsByClassName("dsqjs-order-radio"),p=t.getElementsByClassName("dsqjs-has-more-btn"),j=function(){e(),o(M.page.next)},v=function(s){var t=s.target;M.sortType=t.getAttribute("value"),D(g,M.sortType),e(),M.page.comment=[],M.page.next="",q("dsqjs-post-container").innerHTML='<p class="dsqjs-no-comment">\u6b63\u5728\u5207\u6362\u6392\u5e8f\u65b9\u5f0f...</p>',i.classList.add("dsqjs-hide"),o()},b=""===s?"":"&cursor="+s;i.classList.add("dsqjs-disabled");var y=M.config.api+"3.0/threads/listPostsThreaded?forum="+encodeURIComponent(M.config.shortname)+"&thread="+encodeURIComponent(M.page.id)+encodeURIComponent(b)+"&api_key="+encodeURIComponent(C())+"&order="+encodeURIComponent(M.sortType);T(y).then(function(s){var e,t=s.data;if(0===t.code&&0<t.response.length)i.classList.remove("dsqjs-disabled"),(e=M.page.comment).push.apply(e,t.response),M.page.comment.sort(a),r(M.page.comment),Array.prototype.slice.call(l).forEach(function(s){return s.addEventListener("change",v)}),Array.prototype.slice.call(p).forEach(function(s){return s.addEventListener(h,d)}),t.cursor.hasNext?(M.page.next=t.cursor.next,i.innerHTML="\u52a0\u8f7d\u66f4\u591a\u8bc4\u8bba",i.classList.remove("dsqjs-hide"),i.addEventListener(h,j)):i.classList.add("dsqjs-hide");else{if(0!==t.code||0!==t.response.length)throw new Error;f("\u4f60\u53ef\u80fd\u65e0\u6cd5\u8bbf\u95ee Disqus\uff0c\u5df2\u542f\u7528\u8bc4\u8bba\u57fa\u7840\u6a21\u5f0f\u3002"+L),q("dsqjs-post-container").innerHTML='<p class="dsqjs-no-comment" >'+M.config.nocomment+"</p>",c(),q("dsqjs-force-disqus").addEventListener(h,m)}})["catch"](function(){""===s?u():(i.classList.remove("dsqjs-disabled"),i.innerHTML="\u52a0\u8f7d\u66f4\u591a\u8bc4\u8bba\u5931\u8d25\uff0c\u70b9\u51fb\u91cd\u8bd5",i.addEventListener(h,j))})},r=function(e){function n(s){return s.comment.author.profileUrl?(s.comment.avatarEl='<a href="'+s.comment.author.profileUrl+'"><img src="'+o(s.comment.author.avatar.cache)+'" '+v+"></a>",s.comment.authorEl='<span class="dsqjs-post-author"><a href="'+s.comment.author.profileUrl+'" '+v+">"+s.comment.author.name+"</a></span>"):(s.comment.avatarEl='<img src="'+o(s.comment.author.avatar.cache)+'">',s.comment.authorEl='<span class="dsqjs-post-author">'+s.comment.author.name+"</span>"),M.config.adminLabel&&s.isPrimary&&(s.comment.authorEl+='<span class="dsqjs-admin-badge">'+M.config.adminLabel+"</span>"),s}function r(s){var e="",n="",n=s.isDeleted?"<small>\u6b64\u8bc4\u8bba\u5df2\u88ab\u5220\u9664</small>":(e=s.authorEl+'<span class="dsqjs-bullet"></span>',function(s){var e=t.createElement("div");e.innerHTML=s;var n=e.getElementsByTagName("a");return Array.prototype.slice.call(n).forEach(function(s){var e=decodeURIComponent(s.href.replace(/https:\/\/disq\.us\/url\?url=/g,"")).replace(/(.*):.+cuid=.*/,"$1");s.href=e,s.innerHTML=e,s.rel="external noopener nofollow noreferrer",s.target="_blank"}),e.innerHTML}(o(s.message)));return E(s,e,n)}var o=function(s){return s.replace(/a\.disquscdn\.com/g,"c.disquscdn.com")},a="";s(e).map(function(s){s.children&&(s.nesting=1);var e="";(s=n(s)).hasMore&&(e='<p class="dsqjs-has-more">\u5207\u6362\u81f3 <a id="load-more-'+s.comment.id+'">\u5b8c\u6574 Disqus \u6a21\u5f0f</a> \u663e\u793a\u66f4\u591a\u56de\u590d</p>'),a+='<li data-id="comment-'+s.comment.id+'" id="comment-'+s.comment.id+'">'+r(s.comment)+function t(s){var e=s.nesting,o=s.children||[];if(o){var a="",a=e<M.config.nesting?'<ul class="dsqjs-post-list dsqjs-children">':'<ul class="dsqjs-post-list">';return o.map(function(s){(s=n(s)).nesting=e+1;var o=s.hasMore?'<p class="dsqjs-has-more">\u5207\u6362\u81f3 <a class="dsqjs-has-more-btn" id="load-more-'+s.comment.id+'" data-more-id="comment-'+s.comment.id+'">\u5b8c\u6574 Disqus \u6a21\u5f0f</a> \u663e\u793a\u66f4\u591a\u56de\u590d</p>':"";a+='<li data-id="comment-'+s.comment.id+'" id="comment-'+s.comment.id+'">'+r(s.comment)+t(s)+o+"</li>"}),0!==(a+="</ul>").length?a:void 0}}(s)+e+"</li>"}),f("\u4f60\u53ef\u80fd\u65e0\u6cd5\u8bbf\u95ee Disqus\uff0c\u5df2\u542f\u7528\u8bc4\u8bba\u57fa\u7840\u6a21\u5f0f\u3002"+L),q("dsqjs-post-container").innerHTML=a,c()}}function u(s){console.log(s),f('\u8bc4\u8bba\u57fa\u7840\u6a21\u5f0f\u52a0\u8f7d\u5931\u8d25\uff0c\u662f\u5426 <a id="dsqjs-reload-dsqjs" class="dsqjs-msg-btn">\u91cd\u8f7d</a> \u6216 <a id="dsqjs-reload-disqus" class="dsqjs-msg-btn">\u5c1d\u8bd5\u5b8c\u6574 Disqus \u6a21\u5f0f</a> \uff1f'),q("dsqjs-reload-dsqjs").addEventListener(h,l),q("dsqjs-reload-disqus").addEventListener(h,d)}function m(){D("dsqjs_mode","dsqjs"),l()}function p(){D("dsqjs_mode","disqus"),i()}var q=function(s){return t.getElementById(s)},f=function(s){var e=q("dsqjs-msg");e&&(e.innerHTML=s)},h="click",j="disqus_thread",g="dsqjs_sort",v='target="_blank" rel="external nofollow noopener noreferrer"',b='<footer><p class="dsqjs-footer">Powered by <a class="dsqjs-disqus-logo" href="https://disqus.com" '+v+'></a>&nbsp;&amp;&nbsp;<a href="https://disqusjs.skk.moe" target="_blank">DisqusJS</a></p></footer>',y=function(s,e){return'<header class="dsqjs-header" id="dsqjs-header"><nav class="dsqjs-nav dsqjs-clearfix"><ul><li class="dsqjs-nav-tab dsqjs-tab-active"><span>'+s+' Comments</span></li><li class="dsqjs-nav-tab">'+e+'</li></ul><div class="dsqjs-order"><input class="dsqjs-order-radio" id="dsqjs-order-desc" type="radio" name="comment-order" value="desc" checked="true"><label class="dsqjs-order-label" for="dsqjs-order-desc" title="\u6309\u4ece\u65b0\u5230\u65e7">\u6700\u65b0</label><input class="dsqjs-order-radio" id="dsqjs-order-asc" type="radio" name="comment-order" value="asc"><label class="dsqjs-order-label" for="dsqjs-order-asc" title="\u6309\u4ece\u65e7\u5230\u65b0">\u6700\u65e9</label><input class="dsqjs-order-radio" id="dsqjs-order-popular" type="radio" name="comment-order" value="popular"><label class="dsqjs-order-label" for="dsqjs-order-popular" title="\u6309\u8bc4\u5206\u4ece\u9ad8\u5230\u4f4e">\u6700\u4f73</label></div></nav></header>'},E=function(s,e,t){var n=s.avatarEl,r=s.createdAt;return'<div class="dsqjs-post-item dsqjs-clearfix"><div class="dsqjs-post-avatar">'+n+'</div><div class="dsqjs-post-body"><div class="dsqjs-post-header">'+e+'<span class="dsqjs-meta"><time>'+w(r)+'</time></span></div><div class="dsqjs-post-content">'+t+"</div></div></div>"},L='\u5982\u9700\u5b8c\u6574\u4f53\u9a8c\u8bf7\u9488\u5bf9 disq.us | disquscdn.com | disqus.com \u542f\u7528\u4ee3\u7406\u5e76 <a id="dsqjs-reload-disqus" class="dsqjs-msg-btn">\u5c1d\u8bd5\u5b8c\u6574 Disqus \u6a21\u5f0f</a> | <a id="dsqjs-force-disqus" class="dsqjs-msg-btn">\u5f3a\u5236\u5b8c\u6574 Disqus \u6a21\u5f0f</a>',T=function(s){return r(s,{method:"GET"}).then(function(s){return o.all([s.ok,s.status,s.json(),s.headers])}).then(function(s){var e=s[0],t=s[1],n=s[2],r=s[3];if(e)return{ok:e,status:t,data:n,headers:r};throw new Error})["catch"](function(s){throw s})},D=function(s,e){try{n.setItem(s,e)}catch(s){}},w=function(s){function e(s){return 10>s?"0"+s:s}return s=Date.parse(new Date(s)),(s=new Date(s+288e5)).getFullYear()+"-"+e(s.getMonth()+1)+"-"+e(s.getDate())+" "+e(s.getHours())+":"+e(s.getMinutes())},M={},I=t.location.origin+t.location.pathname+t.location.search;M.config=a({api:"https://disqus.skk.moe/disqus/",identifier:I,url:I,title:t.title,siteName:"",nesting:parseInt(s.nesting)||4,nocomment:"\u8fd9\u91cc\u51b7\u51b7\u6e05\u6e05\u7684\uff0c\u4e00\u6761\u8bc4\u8bba\u90fd\u6ca1\u6709"},s),M.page={};var k=M.config.apikey,C=function(){return Array.isArray(k)?k[Math.floor(Math.random()*k.length)]:k};e.disqus_config=function(){this.page.url=M.config.url,this.page.identifier=M.config.identifier,this.page.title=M.config.title},q(j).innerHTML='<div id="dsqjs"><div id="dsqjs-msg"></div>'+b+"</div>",r&&n&&o?(M.mode=n.getItem("dsqjs_mode"),M.sortType=n.getItem(g)||n.getItem("disqus.sort"),M.sortType||(D(g,"desc"),M.sortType="desc"),("disqus"===M.mode?i:"dsqjs"===M.mode?l:d)()):(f("\u4f60\u7684\u6d4f\u89c8\u5668\u7248\u672c\u8fc7\u4f4e\uff0c\u4e0d\u517c\u5bb9\u8bc4\u8bba\u57fa\u7840\u6a21\u5f0f\u3002"+L),c())}(window,document,localStorage,fetch,Promise)}try{module.exports=DisqusJS}catch(s){}